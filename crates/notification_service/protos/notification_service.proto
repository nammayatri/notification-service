syntax = "proto3";

package notification_service;

// Message for acknowledging notifications
message NotificationAck {
  string id = 1;
}

// Message for the entity associated with the notification
message Entity {
  string id = 1;
  string type = 2;
  string data = 3;  // JSON data as string
}

// Structure of a notification payload
message NotificationPayload {
  string id = 1;
  string category = 2;
  string title = 3;
  string body = 4;
  string show = 5;
  Entity entity = 6;
}


message QuoteResponseWithId {
  string status = 1;
  string reason = 2;
  string search_request_id = 3;
}

message QuoteResponse {
  string status = 1;
  string reason = 2;
}

// Message for the entity associated with the notification
message QuoteRequest {
  string notification_source = 1;
  string rendered_at = 2;
  string responded_at = 3;
  string search_request_id = 4;
  double offered_fare = 5;
  string response = 6;
  int32 slot_number = 7;
}

// Notification service with a single Bi-directional RPC method
service Notification {
  // The RPC method for streaming notifications based on acknowledgments
  rpc StreamPayload(stream NotificationAck) returns (stream NotificationPayload);

  // The RPC method for server side streaming notifications without acknowledgments
  rpc ServerStreamPayload(NotificationAck) returns (stream NotificationPayload);

  rpc QuoteRespond(stream QuoteRequest) returns (stream QuoteResponse);

  rpc QuoteRespondStreamWithId(stream QuoteRequest) returns (stream QuoteResponseWithId);

  rpc QuoteRespondWithId(QuoteRequest) returns (QuoteResponseWithId);
}